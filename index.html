<!DOCTYPE html>
<html>
  <head>
    <title>Проект "Комменты"</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <ul class="comments">
       
      </ul>
      <div class="add-form">
        <input
          type="text"
          class="add-form-name"
          placeholder="Введите ваше имя"
        />
        <textarea
          type="textarea"
          class="add-form-text"
          placeholder="Введите ваш коментарий"
          rows="4"
        ></textarea>
        <div class="add-form-row">
          <button class="add-form-button">Написать</button>
        </div>
      </div>
    </div>
  </body>

  <script>
    "use strict";
    const nameEl = document.querySelector('.add-form-name');
    const commentEl = document.querySelector('.add-form-text');
    const buttonEl = document.querySelector('.add-form-button');
    const list = document.querySelector('.comments');
    let today = new Date();
    let day = String(today.getDate()).padStart(2, '0');
    let month = String(today.getMonth() + 1).padStart(2, '0');
    let year = today.getFullYear().toString().substr(2,2);
    let hours = String(today.getHours()).padStart(2, '0');
let minutes = String(today.getMinutes()).padStart(2, '0');
    let currentDate = `${day}.${month}.${year} ${hours}:${minutes}`;
    
    buttonEl.addEventListener('click', () => {
        if (nameEl.value === ""){
          alert("Имя пользователя не введено!") 
          return;
        }
        if (commentEl.value === ""){
          alert("Комментарий не введен!") 
          return;
        }
       
        comments.push({name: nameEl.value, 
                      time: currentDate, 
                      text: commentEl.value, 
                      likesCounter: 0, 
                      likeActive: false})

        renderComments();
    })

    const comments = [
      {name: "Глеб Фокин", 
      time: "12.02.22 12:18", 
      text: "Это будет первый комментарий на этой странице", 
      likesCounter: 3, 
      likeActive: false},
      {name: "Варвара Н.", 
      time: "13.02.22 19:22", 
      text: "Мне нравится как оформлена эта страница! ❤", 
      likesCounter: 75, 
      likeActive: true},
    ]

    const renderComments = () => {
      
      const commentsHtml = comments.map((comments, like) =>{
        return `<li class="comment">
          <div class="comment-header">
            <div>${comments.name}</div>
            <div>${comments.time}</div>
          </div>
          <div class="comment-body">
            <div class="comment-text">
              ${comments.text}
            </div>
          </div>
          <div class="comment-footer">
            <div class="likes">
              <span class="likes-counter">${comments.likesCounter}</span>
              <button data-like="${like}" class="like-button"></button>
            </div>
          </div>
        </li>`;
        
        
      }).join("");
      
      list.innerHTML = commentsHtml;
      
      const commentLikes = document.querySelectorAll('.like-button', '.-active-like');
    for (const commentLike of commentLikes) {
      commentLike.addEventListener("click", () => {
        console.log("click");
        
       
     const index = Array.from(commentLikes).indexOf(commentLike);
     comments[index].likeActive = !comments[index].likeActive;
     comments[index].likesCounter += comments[index].likeActive ? 1 : -1;
     const imageSrc = comments[index].likeActive ? 
        `url("data:image/svg+xml,%3Csvg width='22' height='20' viewBox='0 0 22 20' fill='none' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath d='M11.11 16.9482L11 17.0572L10.879 16.9482C5.654 12.2507 2.2 9.14441 2.2 5.99455C2.2 3.81471 3.85 2.17984 6.05 2.17984C7.744 2.17984 9.394 3.26975 9.977 4.75204H12.023C12.606 3.26975 14.256 2.17984 15.95 2.17984C18.15 2.17984 19.8 3.81471 19.8 5.99455C19.8 9.14441 16.346 12.2507 11.11 16.9482ZM15.95 0C14.036 0 12.199 0.882834 11 2.26703C9.801 0.882834 7.964 0 6.05 0C2.662 0 0 2.6267 0 5.99455C0 10.1035 3.74 13.4714 9.405 18.5613L11 20L12.595 18.5613C18.26 13.4714 22 10.1035 22 5.99455C22 2.6267 19.338 0 15.95 0Z' fill='%23BCEC30' /%3E%3C/svg%3E")`
        : 
        `url("data:image/svg+xml,%3Csvg width='22' height='20' viewBox='0 0 22 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M15.95 0C14.036 0 12.199 0.882834 11 2.26703C9.801 0.882834 7.964 0 6.05 0C2.662 0 0 2.6267 0 5.99455C0 10.1035 3.74 13.4714 9.405 18.5613L11 20L12.595 18.5613C18.26 13.4714 22 10.1035 22 5.99455C22 2.6267 19.338 0 15.95 0Z' fill='%23BCEC30'/%3E%3C/svg%3E")`;
     renderComments();
     
   
      })
      commentLikes.forEach((commentLike, index) => {
        if (comments[index].likeActive === true) {
        commentLike.classList.add("-active-like");
      } else {
        commentLike.classList.remove("-active-like");
      }
      })
    }
    
     
    }
    
    renderComments();
    

    
  </script>
</html>
